#!/bin/sh -e

if [ $# -lt 1 ]; then
    printf "Usage: $0 makefile-name source-files\n"
    exit 1
fi

makefile=$1
shift
cat << EOM >> $makefile

#############################################################################
# This makefile was generated by $0.
# Do not edit!
#############################################################################

EOM

printf "all: $makefile" > $makefile
for file in $@; do
    printf " ${file}.dbk" >> $makefile
done
printf "\n" >> $makefile

for file in $@; do
    printf "\n${file}.dbk: $file $makefile\n" >> $makefile
    printf "\tdbk-wrap-code $file\n" >> $makefile
done

printf "\nclean:\n\trm -f" >> $makefile
for file in $@; do
    printf " ${file}.dbk" >> $makefile
done
printf "\n" >> $makefile

